# Sorting Homework 2

The makefile is generated running `cmake CMakeLists.txt`. The compilation is then simply performed with `make`.

The plots in point $2$ are obtained using the Gnuplot scripts in the `src` directory. All the data used for the plots are contained in the file `times_select.dat` in the same directory.

## 1. Repeated Values

A generalization of the selection algorithm is needed when dealing with repeated values. In fact, the algorithm seen during lectures fails when all the elements of the input array $A$ are equal.

After splitting $A$ it into chunks,  an upper bound is needed to select the elements of $A$ on which the recursive call will be performed. Splitting in two subarrays according to the median of the medians, the first subarray would contain all the elements of $A$ and the algorithm would get stuck.

A possible solution can be found performing a tripartition of the $A$, introducing one central partition of elements equal to the pivot. In the following pseudo code, the variable `s` counts the number of occurrencies of elements equal to the pivot.

```pseudocode
1. def Tripartition(A, i, j, p):
2.    swap(A, i, p)
3.    (p, i, j, s) ← (i, i+1, j-1, 0)
5.    while i<=j:
6.      if A[j]<A[p]:   
7.        swap(A, i, p-s)
8.        (p, i) ← (i, i+1)
11.       else if A[j]>A[p]:
12.         swap(A, i, j)
13.         j ← j-1
14.       else:
15.         (p, i, s) ← (i, i+1, s+1)
17.     end if
18. 	end while
19.   swap(A, p, j)
20.   k ← (j-s, j)
21.   return k
22. end def 
```

In the pseudo code `k` denotes a pair representing the bounds of the central partition rather than the pivot index.

Each if block takes time $\Theta(1)$ and all these blocks are repeated $\Theta(j-i)$ times. Since all the other operations take time $\Theta(1)$, the tripartition procedure has complexity $\Theta(n)$ where $n$ is the size of the input array $A$.

Since the complexity of the partitioning procedure did not change with respect to the case of just two partitions, the overall complexity of the select procedure is still $\mathcal{O}(n)$.

## 2. Implementation and Results

In order to modify the least the partition algorithm, a `pair` structure is added to the header `select.h` together with the signature of the `tripartition` procedure.

The source file `select.c` contains the auxiliary function `are_equal`, which returns zero if two values are equal and one if the differ. This function is used by the tripartition procedure implemented in the same source file.

The same source file contains also the implementation of the `select_pivot` and `select_index` procedures. The base cases sortings are performed using the quick sort procedure selecting as pivot the first element of the input array. 

The `select_index` procedure is modified with respect to the one seen during the lectures in order to deal correctly with the tripartition procedure.

Finally, the same source file contains the implementation of also the `quick_sort_select` procedure together with its auxiliary function.

All the tests are performed running the executable `test_sorting`. The following plot compares the execution times versus the size $n$ of the input array $A$ for both the versions of $\text{QUICK SORT}$, the one who doesn't use the tripartition procedure and the one who does. The array $A$ contains random values.

![plot1_select](/Users/Mec/Desktop/AD/homework/05_sorting/src/plot1_select.svg)

The quick sort complexity is $\Theta(n\log n)$, both is the average and in the best case as long as the partition procedure costs $\Theta(n)$, as it is in the case of the tripartition procedure. 

Nevertheless, since the average case is a mixture of balanced and unbalanced partitions, the tripartition procedure should always proceduce balanced partitions, thus improving the constant values affecting the scaling. This expectation seems to reasonably fit the previous plot.

The worst case of quick sort, using the procedure partitioning the input array in two subarrays, is when the array $A$ is already sorted. Using the tripartition procedure, this case is now the best one since the almost median pivot selected should already be central. 

The previous hypothesis should be confirmed from an asymptotic point of view but the expected behaviour is not noticeable for the sizes considered, maybe due to the overhead time taken by the tripartition procedure.

## 3. Chunks Sizes

If the elements of the input array of size $n$ are divided in chunks of $7$, there will be $\left \lceil{n/7}\right \rceil$ chunks. Therefore there will be $\left \lceil\left \lceil{n/7}\right \rceil/2\right \rceil$ median elements greater than the median of the medians.

The number of chunks having at least $4$ elements greater than the median of the medians will be $\left \lceil\left \lceil{n/7}\right \rceil/2\right \rceil-2$ so the least number of elements greater than the median of the medians will be $4(\left \lceil\left \lceil{n/7}\right \rceil/2\right \rceil-2)$.

This least number of elements is greater or equal than $2n/7-8$, therefore un upper bound for the number of elements smaller or equal than the median of the medians is $5n/7+8$.

The resulting complexity equation is then $T_s(n)=T_s(\left \lceil{n/7}\right \rceil)+T_s(5n/7+8)+\Theta(n)$. This equation can be solved by the substitution method. Let $cn$ and $c′n$ be representatives of $\mathcal{O}(n)$ and $\Theta(n)$ and assume as inductive hypothesis $T_s(m)\leq cm$ for all $m < n$.

It follows that $T_s(n)\leq 6/7nc+9c+c'n$ if assuming that $n>7$ and $5n/7+8<n$. The latter condition is rewritten as $n>28$. Assuming $c\geq28c'$, it follows again that $T_s(n)\leq 25/28nc+9c$.

Then, if $n\geq84$ it follows that $T_s(n)\leq cn$ and therefore that $T_s(n)\in\mathcal{O}(n)$ for all $n\geq 84$ and for all $c\geq 28c'$.

If instead the elements of the input array of size $n$ are divided in chunks of $3$, there will be $\left \lceil{n/3}\right \rceil$ chunks. Therefore there will be $\left \lceil\left \lceil{n/3}\right \rceil/2\right \rceil$ median elements greater than the median of the medians.

The number of chunks having at least $2$ elements greater than the median of the medians will be $\left \lceil\left \lceil{n/3}\right \rceil/2\right \rceil-2$ so the least number of elements greater than the median of the medians will be $2(\left \lceil\left \lceil{n/3}\right \rceil/2\right \rceil-2)$.

This least number of elements is greater or equal than $n/3-4$, therefore un upper bound for the number of elements smaller or equal than the median of the medians is $2n/3+4$.

The resulting complexity equation is then $T_s(n)=T_s(\left \lceil{n/3}\right \rceil)+T_s(2n/3+4)+\Theta(n)$. This equation can be solved by the substitution method. Let $cn$ and $c′n$ be representatives of $\mathcal{O}(n)$ and $\Theta(n)$ and assume as inductive hypothesis $T_s(m)\leq cm$ for all $m < n$.

It follows that $T_s(n)\leq nc+5c+c'n$ if assuming that $n>3$ and $2n/3+4<n$. The latter condition is rewritten as $n>12$. Assuming $c\geq12c'$, it follows again that $T_s(n)\leq 13/12nc+5c$. 

Since it does not exist a value of $n$ such that $13/12n+5\leq n$, it follows that the hypothesis $T_s(n)\in\mathcal{O}(n)$ does not hold.

##4. Selection Problem

The `BlackBox` procedure applied to the input array $A$ returns the position of the value that would be in position $n/2$ if $A$ were sorted. If the target index $i$ is equal to $n/2$, then the problem is solved. 

Otherwise, $A$ is partitioned in two subarrays, the first one of values lower than $A[n/2]$ and the second one of values greater than $A[n/2]$. 

If the target index $i$ is smaller than $n/2$, the algorithm is recursively called on the first subarray and the problem is solved when the returned index is equal to $i$. Otherwise, the algorithm is recursively called on the second subarray and the problem is solved when the returned index is equal to $i-n/2$.

It follows the pseudo code for the above algorithm. The `Partition` procedure takes as input an index in $A$ and returns the position that that index would have in the sorted array.

```pseudocode
1. def Select(A, l=1, r=|A|, i):
2.    if l=r:
3.      return A[l]
4.    end if
5.    m ← BlackBox(A, l, r)
6.    p ← Partition(A, m)
7.    k ← p-l+1
8.    if i=k:
9.      return A[k]
10.     else if i<k:
11.       return Select(A, l, p-1, i)
12.     else:
13.       return Select(A, p+1, r, i-k)
14.   end if
15. end def 
```

Both the `BlackBox` and the `Partition` procedures take time $\mathcal{O}(n)$. All the other operations, apart from the multiple if cycle, take constant time $\Theta(1)$. The recursive complexity equation is therefore written as $T_s(n)=\mathcal{O}(n)+T_s(n/2)$.

Taking $cn$ as representative of $\mathcal{O}(n)$, it follows that $T_s(n)\leq cn+T_s(n/2)$. Expanding the recursion, since $T_s(1)\in\Theta(1)$, it follows that $T_s(n)\leq cn(1+1/2+1/4+\dots)\leq 2cn$ and therefore $T_s(n)\in\mathcal{O}(n)$.

##5. Recursive Equations

The first equation to be solved is $T_1(n)=2*T_1(n/2)+\mathcal{O}(n)$. A recursion tree can be used to model this equation. The first four levels of the recursion tree relative to $T_1(n)$ are shown in the following graph, where $cn$ is chosen as representative of the set $\mathcal{O}(n)$.

[![](https://mermaid.ink/img/eyJjb2RlIjoiZ3JhcGggVERcblx0MShcImNuXCIpIC0tPiAyKFwiY24vMlwiKVxuICAxKFwiY25cIikgLS0-IDMoXCJjbi8yXCIpXG4gIDIoXCJjbi8yXCIpIC0tPiA0KFwiY24vNFwiKVxuICAyKFwiY24vMlwiKSAtLT4gNShcImNuLzRcIilcbiAgMyhcImNuLzJcIikgLS0-IDYoXCJjbi80XCIpXG4gIDMoXCJjbi8yXCIpIC0tPiA3KFwiY24vNFwiKVxuICA0KFwiY24vNFwiKSAtLT4gOChcImNuLzhcIilcbiAgNChcImNuLzRcIikgLS0-IDkoXCJjbi84XCIpXG4gIDUoXCJjbi80XCIpIC0tPiAxMChcImNuLzhcIilcbiAgNShcImNuLzRcIikgLS0-IDExKFwiY24vOFwiKVxuICA2KFwiY24vNFwiKSAtLT4gMTIoXCJjbi84XCIpXG4gIDYoXCJjbi80XCIpIC0tPiAxMyhcImNuLzhcIilcbiAgNyhcImNuLzRcIikgLS0-IDE0KFwiY24vOFwiKVxuICA3KFwiY24vNFwiKSAtLT4gMTUoXCJjbi84XCIpXG4gICIsIm1lcm1haWQiOnsidGhlbWUiOiJkZWZhdWx0IiwiZmxvd2NoYXJ0Ijp7ImN1cnZlIjoiYmFzaXMifSwidGhlbWVWYXJpYWJsZXMiOnsiYmFja2dyb3VuZCI6IndoaXRlIiwicHJpbWFyeUNvbG9yIjoiI0VDRUNGRiIsInNlY29uZGFyeUNvbG9yIjoiI2ZmZmZkZSIsInRlcnRpYXJ5Q29sb3IiOiJoc2woODAsIDEwMCUsIDk2LjI3NDUwOTgwMzklKSIsInByaW1hcnlCb3JkZXJDb2xvciI6ImhzbCgyNDAsIDYwJSwgODYuMjc0NTA5ODAzOSUpIiwic2Vjb25kYXJ5Qm9yZGVyQ29sb3IiOiJoc2woNjAsIDYwJSwgODMuNTI5NDExNzY0NyUpIiwidGVydGlhcnlCb3JkZXJDb2xvciI6ImhzbCg4MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJwcmltYXJ5VGV4dENvbG9yIjoiIzEzMTMwMCIsInNlY29uZGFyeVRleHRDb2xvciI6IiMwMDAwMjEiLCJ0ZXJ0aWFyeVRleHRDb2xvciI6InJnYig5LjUwMDAwMDAwMDEsIDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxKSIsImxpbmVDb2xvciI6IiMzMzMzMzMiLCJ0ZXh0Q29sb3IiOiIjMzMzIiwibWFpbkJrZyI6IiNFQ0VDRkYiLCJzZWNvbmRCa2ciOiIjZmZmZmRlIiwiYm9yZGVyMSI6IiM5MzcwREIiLCJib3JkZXIyIjoiI2FhYWEzMyIsImFycm93aGVhZENvbG9yIjoiIzMzMzMzMyIsImZvbnRGYW1pbHkiOiJcInRyZWJ1Y2hldCBtc1wiLCB2ZXJkYW5hLCBhcmlhbCIsImZvbnRTaXplIjoiMTZweCIsImxhYmVsQmFja2dyb3VuZCI6IiNlOGU4ZTgiLCJub2RlQmtnIjoiI0VDRUNGRiIsIm5vZGVCb3JkZXIiOiIjOTM3MERCIiwiY2x1c3RlckJrZyI6IiNmZmZmZGUiLCJjbHVzdGVyQm9yZGVyIjoiI2FhYWEzMyIsImRlZmF1bHRMaW5rQ29sb3IiOiIjMzMzMzMzIiwidGl0bGVDb2xvciI6IiMzMzMiLCJlZGdlTGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsImFjdG9yQm9yZGVyIjoiaHNsKDI1OS42MjYxNjgyMjQzLCA1OS43NzY1MzYzMTI4JSwgODcuOTAxOTYwNzg0MyUpIiwiYWN0b3JCa2ciOiIjRUNFQ0ZGIiwiYWN0b3JUZXh0Q29sb3IiOiJibGFjayIsImFjdG9yTGluZUNvbG9yIjoiZ3JleSIsInNpZ25hbENvbG9yIjoiIzMzMyIsInNpZ25hbFRleHRDb2xvciI6IiMzMzMiLCJsYWJlbEJveEJrZ0NvbG9yIjoiI0VDRUNGRiIsImxhYmVsQm94Qm9yZGVyQ29sb3IiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJsYWJlbFRleHRDb2xvciI6ImJsYWNrIiwibG9vcFRleHRDb2xvciI6ImJsYWNrIiwibm90ZUJvcmRlckNvbG9yIjoiI2FhYWEzMyIsIm5vdGVCa2dDb2xvciI6IiNmZmY1YWQiLCJub3RlVGV4dENvbG9yIjoiYmxhY2siLCJhY3RpdmF0aW9uQm9yZGVyQ29sb3IiOiIjNjY2IiwiYWN0aXZhdGlvbkJrZ0NvbG9yIjoiI2Y0ZjRmNCIsInNlcXVlbmNlTnVtYmVyQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvciI6InJnYmEoMTAyLCAxMDIsIDI1NSwgMC40OSkiLCJhbHRTZWN0aW9uQmtnQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvcjIiOiIjZmZmNDAwIiwidGFza0JvcmRlckNvbG9yIjoiIzUzNGZiYyIsInRhc2tCa2dDb2xvciI6IiM4YTkwZGQiLCJ0YXNrVGV4dExpZ2h0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0RGFya0NvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dE91dHNpZGVDb2xvciI6ImJsYWNrIiwidGFza1RleHRDbGlja2FibGVDb2xvciI6IiMwMDMxNjMiLCJhY3RpdmVUYXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwiYWN0aXZlVGFza0JrZ0NvbG9yIjoiI2JmYzdmZiIsImdyaWRDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQmtnQ29sb3IiOiJsaWdodGdyZXkiLCJkb25lVGFza0JvcmRlckNvbG9yIjoiZ3JleSIsImNyaXRCb3JkZXJDb2xvciI6IiNmZjg4ODgiLCJjcml0QmtnQ29sb3IiOiJyZWQiLCJ0b2RheUxpbmVDb2xvciI6InJlZCIsImxhYmVsQ29sb3IiOiJibGFjayIsImVycm9yQmtnQ29sb3IiOiIjNTUyMjIyIiwiZXJyb3JUZXh0Q29sb3IiOiIjNTUyMjIyIiwiY2xhc3NUZXh0IjoiIzEzMTMwMCIsImZpbGxUeXBlMCI6IiNFQ0VDRkYiLCJmaWxsVHlwZTEiOiIjZmZmZmRlIiwiZmlsbFR5cGUyIjoiaHNsKDMwNCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGUzIjoiaHNsKDEyNCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIiwiZmlsbFR5cGU0IjoiaHNsKDE3NiwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU1IjoiaHNsKC00LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTYiOiJoc2woOCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU3IjoiaHNsKDE4OCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIn19LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiZ3JhcGggVERcblx0MShcImNuXCIpIC0tPiAyKFwiY24vMlwiKVxuICAxKFwiY25cIikgLS0-IDMoXCJjbi8yXCIpXG4gIDIoXCJjbi8yXCIpIC0tPiA0KFwiY24vNFwiKVxuICAyKFwiY24vMlwiKSAtLT4gNShcImNuLzRcIilcbiAgMyhcImNuLzJcIikgLS0-IDYoXCJjbi80XCIpXG4gIDMoXCJjbi8yXCIpIC0tPiA3KFwiY24vNFwiKVxuICA0KFwiY24vNFwiKSAtLT4gOChcImNuLzhcIilcbiAgNChcImNuLzRcIikgLS0-IDkoXCJjbi84XCIpXG4gIDUoXCJjbi80XCIpIC0tPiAxMChcImNuLzhcIilcbiAgNShcImNuLzRcIikgLS0-IDExKFwiY24vOFwiKVxuICA2KFwiY24vNFwiKSAtLT4gMTIoXCJjbi84XCIpXG4gIDYoXCJjbi80XCIpIC0tPiAxMyhcImNuLzhcIilcbiAgNyhcImNuLzRcIikgLS0-IDE0KFwiY24vOFwiKVxuICA3KFwiY24vNFwiKSAtLT4gMTUoXCJjbi84XCIpXG4gICIsIm1lcm1haWQiOnsidGhlbWUiOiJkZWZhdWx0IiwiZmxvd2NoYXJ0Ijp7ImN1cnZlIjoiYmFzaXMifSwidGhlbWVWYXJpYWJsZXMiOnsiYmFja2dyb3VuZCI6IndoaXRlIiwicHJpbWFyeUNvbG9yIjoiI0VDRUNGRiIsInNlY29uZGFyeUNvbG9yIjoiI2ZmZmZkZSIsInRlcnRpYXJ5Q29sb3IiOiJoc2woODAsIDEwMCUsIDk2LjI3NDUwOTgwMzklKSIsInByaW1hcnlCb3JkZXJDb2xvciI6ImhzbCgyNDAsIDYwJSwgODYuMjc0NTA5ODAzOSUpIiwic2Vjb25kYXJ5Qm9yZGVyQ29sb3IiOiJoc2woNjAsIDYwJSwgODMuNTI5NDExNzY0NyUpIiwidGVydGlhcnlCb3JkZXJDb2xvciI6ImhzbCg4MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJwcmltYXJ5VGV4dENvbG9yIjoiIzEzMTMwMCIsInNlY29uZGFyeVRleHRDb2xvciI6IiMwMDAwMjEiLCJ0ZXJ0aWFyeVRleHRDb2xvciI6InJnYig5LjUwMDAwMDAwMDEsIDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxKSIsImxpbmVDb2xvciI6IiMzMzMzMzMiLCJ0ZXh0Q29sb3IiOiIjMzMzIiwibWFpbkJrZyI6IiNFQ0VDRkYiLCJzZWNvbmRCa2ciOiIjZmZmZmRlIiwiYm9yZGVyMSI6IiM5MzcwREIiLCJib3JkZXIyIjoiI2FhYWEzMyIsImFycm93aGVhZENvbG9yIjoiIzMzMzMzMyIsImZvbnRGYW1pbHkiOiJcInRyZWJ1Y2hldCBtc1wiLCB2ZXJkYW5hLCBhcmlhbCIsImZvbnRTaXplIjoiMTZweCIsImxhYmVsQmFja2dyb3VuZCI6IiNlOGU4ZTgiLCJub2RlQmtnIjoiI0VDRUNGRiIsIm5vZGVCb3JkZXIiOiIjOTM3MERCIiwiY2x1c3RlckJrZyI6IiNmZmZmZGUiLCJjbHVzdGVyQm9yZGVyIjoiI2FhYWEzMyIsImRlZmF1bHRMaW5rQ29sb3IiOiIjMzMzMzMzIiwidGl0bGVDb2xvciI6IiMzMzMiLCJlZGdlTGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsImFjdG9yQm9yZGVyIjoiaHNsKDI1OS42MjYxNjgyMjQzLCA1OS43NzY1MzYzMTI4JSwgODcuOTAxOTYwNzg0MyUpIiwiYWN0b3JCa2ciOiIjRUNFQ0ZGIiwiYWN0b3JUZXh0Q29sb3IiOiJibGFjayIsImFjdG9yTGluZUNvbG9yIjoiZ3JleSIsInNpZ25hbENvbG9yIjoiIzMzMyIsInNpZ25hbFRleHRDb2xvciI6IiMzMzMiLCJsYWJlbEJveEJrZ0NvbG9yIjoiI0VDRUNGRiIsImxhYmVsQm94Qm9yZGVyQ29sb3IiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJsYWJlbFRleHRDb2xvciI6ImJsYWNrIiwibG9vcFRleHRDb2xvciI6ImJsYWNrIiwibm90ZUJvcmRlckNvbG9yIjoiI2FhYWEzMyIsIm5vdGVCa2dDb2xvciI6IiNmZmY1YWQiLCJub3RlVGV4dENvbG9yIjoiYmxhY2siLCJhY3RpdmF0aW9uQm9yZGVyQ29sb3IiOiIjNjY2IiwiYWN0aXZhdGlvbkJrZ0NvbG9yIjoiI2Y0ZjRmNCIsInNlcXVlbmNlTnVtYmVyQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvciI6InJnYmEoMTAyLCAxMDIsIDI1NSwgMC40OSkiLCJhbHRTZWN0aW9uQmtnQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvcjIiOiIjZmZmNDAwIiwidGFza0JvcmRlckNvbG9yIjoiIzUzNGZiYyIsInRhc2tCa2dDb2xvciI6IiM4YTkwZGQiLCJ0YXNrVGV4dExpZ2h0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0RGFya0NvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dE91dHNpZGVDb2xvciI6ImJsYWNrIiwidGFza1RleHRDbGlja2FibGVDb2xvciI6IiMwMDMxNjMiLCJhY3RpdmVUYXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwiYWN0aXZlVGFza0JrZ0NvbG9yIjoiI2JmYzdmZiIsImdyaWRDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQmtnQ29sb3IiOiJsaWdodGdyZXkiLCJkb25lVGFza0JvcmRlckNvbG9yIjoiZ3JleSIsImNyaXRCb3JkZXJDb2xvciI6IiNmZjg4ODgiLCJjcml0QmtnQ29sb3IiOiJyZWQiLCJ0b2RheUxpbmVDb2xvciI6InJlZCIsImxhYmVsQ29sb3IiOiJibGFjayIsImVycm9yQmtnQ29sb3IiOiIjNTUyMjIyIiwiZXJyb3JUZXh0Q29sb3IiOiIjNTUyMjIyIiwiY2xhc3NUZXh0IjoiIzEzMTMwMCIsImZpbGxUeXBlMCI6IiNFQ0VDRkYiLCJmaWxsVHlwZTEiOiIjZmZmZmRlIiwiZmlsbFR5cGUyIjoiaHNsKDMwNCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGUzIjoiaHNsKDEyNCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIiwiZmlsbFR5cGU0IjoiaHNsKDE3NiwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU1IjoiaHNsKC00LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTYiOiJoc2woOCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU3IjoiaHNsKDE4OCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIn19LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

Each level has at most $2^i$ nodes and each node has a cost of at most $cn/2^i$, therefore each level has a cost of at most $cn$, which is independent of the height of the tree, which is $\log_2n$.

It follows that $T_1(n)\leq cn\sum_{i=0}^{\log_2n}1=cn\log_2n$. Therefore $T_1(n)\in\mathcal{O}(n\log_2n)$.

Using instead the substitution method, $cn\log_2n$ and $c'n$ are chosen as representatives of the sets $\mathcal{O}(n\log_2n)$ and $\mathcal{O}(n)$. The inductive hypothesis is $T_1(m)\leq cm\log_2m$ for all $m<n$.

It follows that the recursive equation is rewritten as $T_1(n)\leq cn \log_2n-cn+c'n$ using the logarithm properties. Finally, assuming that $c'\leq c$, it follows that $T_1(n)\leq cn\log_2n$ and so $T_1(n)\in\mathcal{O}(n\log_2 n)$.

The second equation to be solved is $T_2(n) = T_2(\left \lceil{n/2}\right \rceil) + T_2(\left \lfloor{n/2}\right \rfloor) + \Theta(1)$. A recursion tree can be used to model this equation. This tree is unbalanced since the leftmost branch involves only ceiling operations and the rightmost branch only floor operations.

Moreover, each level of depth has at most twice the number of nodes of the level above and each node has a constant complexity $c$. It follows that the level $i$ has an overall cost of at most $2^ic$.

Since for every $n$ there exists a power of $2$ in the interval $[n,2n]$, the leftmost branch has a lenght of at most $\log_2(2n)$. Therefore $T_2(n)\leq c\sum_{i=0}^{\log_2(2n)}2^i=4cn-c$ using the properties of the geometric series. The complexity of $T_2(n)$ is therefore bounded from above as $T_2(n)\in\mathcal{O}(n)$.

Since for every $n$ there exists a power of $2$ in the interval $[n/2,n]$, the rightmost branch has a lenght of at least $\log_2(n/2)$. Therefore $T_2(n)\geq c\sum_{i=0}^{\log_2(n/2)}2^i=cn-c$ using the properties of the geometric series. The complexity of $T_2(n)$ is therefore bounded from below, since $T_2(n)\in\Omega(n)$. 

Putting both bounds together, it follows that $T_2(n)\in\Theta(n)$.

Using instead the substitution method, $cn-d$ and $c'$ are chosen as representatives of the sets $\mathcal{O}(n)$ and $\Theta(1)$. The inductive hypothesis is $T_2(m)\leq cm-d$ for all $m<n$.

It follows that the recursive equation is rewritten as $T_2(n) \leq c\left \lceil{n/2}\right \rceil + c\left \lfloor{n/2}\right \rfloor -2d + c'\leq cn-2d+c'$. Finally, assuming that $c'\leq d$, it follows that $T_2(n)\leq cn-d$ and so $T_2(n)\in\mathcal{O}(n)$.

Now $cn$ and $c'$ are chosen as representatives of the sets $\Omega(n)$ and $\Theta(1)$. Assuming as inductive hypothesis $T_2(m)\geq cm$ for all $m<n$, the recursive equation is rewritten as $T_2(n) \geq c\left \lceil{n/2}\right \rceil + c\left \lfloor{n/2}\right \rfloor  + c'\geq cn+c'$. Finally, assuming that $c'\geq 0$, it follows that $T_2(n)\geq cn$ and so $T_2(n)\in\Omega(n)$.

Putting both bounds together, it follows that $T_2(n)\in\Theta(n)$.

The third equation to be solved is $T_3(n)=3*T_3(n/2)+\mathcal{O}(n)$. A recursion tree can be used to model this equation. The first three levels of the recursion tree relative to $T_3(n)$ are shown in the following graph, where $cn$ is chosen as representative of the set $\mathcal{O}(n)$.

[![](https://mermaid.ink/img/eyJjb2RlIjoiZ3JhcGggVERcblx0MShcImNuXCIpIC0tPiAyKFwiY24vMlwiKVxuICAxKFwiY25cIikgLS0-IDMoXCJjbi8yXCIpXG4gIDEoXCJjblwiKSAtLT4gNChcImNuLzJcIilcbiAgMihcImNuLzJcIikgLS0-IDUoXCJjbi80XCIpXG4gIDIoXCJjbi8yXCIpIC0tPiA2KFwiY24vNFwiKVxuICAyKFwiY24vMlwiKSAtLT4gNyhcImNuLzRcIilcbiAgMyhcImNuLzJcIikgLS0-IDgoXCJjbi80XCIpXG4gIDMoXCJjbi8yXCIpIC0tPiA5KFwiY24vNFwiKVxuICAzKFwiY24vMlwiKSAtLT4gMTAoXCJjbi80XCIpXG4gIDQoXCJjbi8yXCIpIC0tPiAxMShcImNuLzRcIilcbiAgNChcImNuLzJcIikgLS0-IDEyKFwiY24vNFwiKVxuICA0KFwiY24vMlwiKSAtLT4gMTMoXCJjbi80XCIpXG4gICIsIm1lcm1haWQiOnsidGhlbWUiOiJkZWZhdWx0IiwiZmxvd2NoYXJ0Ijp7ImN1cnZlIjoiYmFzaXMifSwidGhlbWVWYXJpYWJsZXMiOnsiYmFja2dyb3VuZCI6IndoaXRlIiwicHJpbWFyeUNvbG9yIjoiI0VDRUNGRiIsInNlY29uZGFyeUNvbG9yIjoiI2ZmZmZkZSIsInRlcnRpYXJ5Q29sb3IiOiJoc2woODAsIDEwMCUsIDk2LjI3NDUwOTgwMzklKSIsInByaW1hcnlCb3JkZXJDb2xvciI6ImhzbCgyNDAsIDYwJSwgODYuMjc0NTA5ODAzOSUpIiwic2Vjb25kYXJ5Qm9yZGVyQ29sb3IiOiJoc2woNjAsIDYwJSwgODMuNTI5NDExNzY0NyUpIiwidGVydGlhcnlCb3JkZXJDb2xvciI6ImhzbCg4MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJwcmltYXJ5VGV4dENvbG9yIjoiIzEzMTMwMCIsInNlY29uZGFyeVRleHRDb2xvciI6IiMwMDAwMjEiLCJ0ZXJ0aWFyeVRleHRDb2xvciI6InJnYig5LjUwMDAwMDAwMDEsIDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxKSIsImxpbmVDb2xvciI6IiMzMzMzMzMiLCJ0ZXh0Q29sb3IiOiIjMzMzIiwibWFpbkJrZyI6IiNFQ0VDRkYiLCJzZWNvbmRCa2ciOiIjZmZmZmRlIiwiYm9yZGVyMSI6IiM5MzcwREIiLCJib3JkZXIyIjoiI2FhYWEzMyIsImFycm93aGVhZENvbG9yIjoiIzMzMzMzMyIsImZvbnRGYW1pbHkiOiJcInRyZWJ1Y2hldCBtc1wiLCB2ZXJkYW5hLCBhcmlhbCIsImZvbnRTaXplIjoiMTZweCIsImxhYmVsQmFja2dyb3VuZCI6IiNlOGU4ZTgiLCJub2RlQmtnIjoiI0VDRUNGRiIsIm5vZGVCb3JkZXIiOiIjOTM3MERCIiwiY2x1c3RlckJrZyI6IiNmZmZmZGUiLCJjbHVzdGVyQm9yZGVyIjoiI2FhYWEzMyIsImRlZmF1bHRMaW5rQ29sb3IiOiIjMzMzMzMzIiwidGl0bGVDb2xvciI6IiMzMzMiLCJlZGdlTGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsImFjdG9yQm9yZGVyIjoiaHNsKDI1OS42MjYxNjgyMjQzLCA1OS43NzY1MzYzMTI4JSwgODcuOTAxOTYwNzg0MyUpIiwiYWN0b3JCa2ciOiIjRUNFQ0ZGIiwiYWN0b3JUZXh0Q29sb3IiOiJibGFjayIsImFjdG9yTGluZUNvbG9yIjoiZ3JleSIsInNpZ25hbENvbG9yIjoiIzMzMyIsInNpZ25hbFRleHRDb2xvciI6IiMzMzMiLCJsYWJlbEJveEJrZ0NvbG9yIjoiI0VDRUNGRiIsImxhYmVsQm94Qm9yZGVyQ29sb3IiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJsYWJlbFRleHRDb2xvciI6ImJsYWNrIiwibG9vcFRleHRDb2xvciI6ImJsYWNrIiwibm90ZUJvcmRlckNvbG9yIjoiI2FhYWEzMyIsIm5vdGVCa2dDb2xvciI6IiNmZmY1YWQiLCJub3RlVGV4dENvbG9yIjoiYmxhY2siLCJhY3RpdmF0aW9uQm9yZGVyQ29sb3IiOiIjNjY2IiwiYWN0aXZhdGlvbkJrZ0NvbG9yIjoiI2Y0ZjRmNCIsInNlcXVlbmNlTnVtYmVyQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvciI6InJnYmEoMTAyLCAxMDIsIDI1NSwgMC40OSkiLCJhbHRTZWN0aW9uQmtnQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvcjIiOiIjZmZmNDAwIiwidGFza0JvcmRlckNvbG9yIjoiIzUzNGZiYyIsInRhc2tCa2dDb2xvciI6IiM4YTkwZGQiLCJ0YXNrVGV4dExpZ2h0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0RGFya0NvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dE91dHNpZGVDb2xvciI6ImJsYWNrIiwidGFza1RleHRDbGlja2FibGVDb2xvciI6IiMwMDMxNjMiLCJhY3RpdmVUYXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwiYWN0aXZlVGFza0JrZ0NvbG9yIjoiI2JmYzdmZiIsImdyaWRDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQmtnQ29sb3IiOiJsaWdodGdyZXkiLCJkb25lVGFza0JvcmRlckNvbG9yIjoiZ3JleSIsImNyaXRCb3JkZXJDb2xvciI6IiNmZjg4ODgiLCJjcml0QmtnQ29sb3IiOiJyZWQiLCJ0b2RheUxpbmVDb2xvciI6InJlZCIsImxhYmVsQ29sb3IiOiJibGFjayIsImVycm9yQmtnQ29sb3IiOiIjNTUyMjIyIiwiZXJyb3JUZXh0Q29sb3IiOiIjNTUyMjIyIiwiY2xhc3NUZXh0IjoiIzEzMTMwMCIsImZpbGxUeXBlMCI6IiNFQ0VDRkYiLCJmaWxsVHlwZTEiOiIjZmZmZmRlIiwiZmlsbFR5cGUyIjoiaHNsKDMwNCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGUzIjoiaHNsKDEyNCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIiwiZmlsbFR5cGU0IjoiaHNsKDE3NiwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU1IjoiaHNsKC00LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTYiOiJoc2woOCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU3IjoiaHNsKDE4OCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIn19LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiZ3JhcGggVERcblx0MShcImNuXCIpIC0tPiAyKFwiY24vMlwiKVxuICAxKFwiY25cIikgLS0-IDMoXCJjbi8yXCIpXG4gIDEoXCJjblwiKSAtLT4gNChcImNuLzJcIilcbiAgMihcImNuLzJcIikgLS0-IDUoXCJjbi80XCIpXG4gIDIoXCJjbi8yXCIpIC0tPiA2KFwiY24vNFwiKVxuICAyKFwiY24vMlwiKSAtLT4gNyhcImNuLzRcIilcbiAgMyhcImNuLzJcIikgLS0-IDgoXCJjbi80XCIpXG4gIDMoXCJjbi8yXCIpIC0tPiA5KFwiY24vNFwiKVxuICAzKFwiY24vMlwiKSAtLT4gMTAoXCJjbi80XCIpXG4gIDQoXCJjbi8yXCIpIC0tPiAxMShcImNuLzRcIilcbiAgNChcImNuLzJcIikgLS0-IDEyKFwiY24vNFwiKVxuICA0KFwiY24vMlwiKSAtLT4gMTMoXCJjbi80XCIpXG4gICIsIm1lcm1haWQiOnsidGhlbWUiOiJkZWZhdWx0IiwiZmxvd2NoYXJ0Ijp7ImN1cnZlIjoiYmFzaXMifSwidGhlbWVWYXJpYWJsZXMiOnsiYmFja2dyb3VuZCI6IndoaXRlIiwicHJpbWFyeUNvbG9yIjoiI0VDRUNGRiIsInNlY29uZGFyeUNvbG9yIjoiI2ZmZmZkZSIsInRlcnRpYXJ5Q29sb3IiOiJoc2woODAsIDEwMCUsIDk2LjI3NDUwOTgwMzklKSIsInByaW1hcnlCb3JkZXJDb2xvciI6ImhzbCgyNDAsIDYwJSwgODYuMjc0NTA5ODAzOSUpIiwic2Vjb25kYXJ5Qm9yZGVyQ29sb3IiOiJoc2woNjAsIDYwJSwgODMuNTI5NDExNzY0NyUpIiwidGVydGlhcnlCb3JkZXJDb2xvciI6ImhzbCg4MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJwcmltYXJ5VGV4dENvbG9yIjoiIzEzMTMwMCIsInNlY29uZGFyeVRleHRDb2xvciI6IiMwMDAwMjEiLCJ0ZXJ0aWFyeVRleHRDb2xvciI6InJnYig5LjUwMDAwMDAwMDEsIDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxKSIsImxpbmVDb2xvciI6IiMzMzMzMzMiLCJ0ZXh0Q29sb3IiOiIjMzMzIiwibWFpbkJrZyI6IiNFQ0VDRkYiLCJzZWNvbmRCa2ciOiIjZmZmZmRlIiwiYm9yZGVyMSI6IiM5MzcwREIiLCJib3JkZXIyIjoiI2FhYWEzMyIsImFycm93aGVhZENvbG9yIjoiIzMzMzMzMyIsImZvbnRGYW1pbHkiOiJcInRyZWJ1Y2hldCBtc1wiLCB2ZXJkYW5hLCBhcmlhbCIsImZvbnRTaXplIjoiMTZweCIsImxhYmVsQmFja2dyb3VuZCI6IiNlOGU4ZTgiLCJub2RlQmtnIjoiI0VDRUNGRiIsIm5vZGVCb3JkZXIiOiIjOTM3MERCIiwiY2x1c3RlckJrZyI6IiNmZmZmZGUiLCJjbHVzdGVyQm9yZGVyIjoiI2FhYWEzMyIsImRlZmF1bHRMaW5rQ29sb3IiOiIjMzMzMzMzIiwidGl0bGVDb2xvciI6IiMzMzMiLCJlZGdlTGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsImFjdG9yQm9yZGVyIjoiaHNsKDI1OS42MjYxNjgyMjQzLCA1OS43NzY1MzYzMTI4JSwgODcuOTAxOTYwNzg0MyUpIiwiYWN0b3JCa2ciOiIjRUNFQ0ZGIiwiYWN0b3JUZXh0Q29sb3IiOiJibGFjayIsImFjdG9yTGluZUNvbG9yIjoiZ3JleSIsInNpZ25hbENvbG9yIjoiIzMzMyIsInNpZ25hbFRleHRDb2xvciI6IiMzMzMiLCJsYWJlbEJveEJrZ0NvbG9yIjoiI0VDRUNGRiIsImxhYmVsQm94Qm9yZGVyQ29sb3IiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJsYWJlbFRleHRDb2xvciI6ImJsYWNrIiwibG9vcFRleHRDb2xvciI6ImJsYWNrIiwibm90ZUJvcmRlckNvbG9yIjoiI2FhYWEzMyIsIm5vdGVCa2dDb2xvciI6IiNmZmY1YWQiLCJub3RlVGV4dENvbG9yIjoiYmxhY2siLCJhY3RpdmF0aW9uQm9yZGVyQ29sb3IiOiIjNjY2IiwiYWN0aXZhdGlvbkJrZ0NvbG9yIjoiI2Y0ZjRmNCIsInNlcXVlbmNlTnVtYmVyQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvciI6InJnYmEoMTAyLCAxMDIsIDI1NSwgMC40OSkiLCJhbHRTZWN0aW9uQmtnQ29sb3IiOiJ3aGl0ZSIsInNlY3Rpb25Ca2dDb2xvcjIiOiIjZmZmNDAwIiwidGFza0JvcmRlckNvbG9yIjoiIzUzNGZiYyIsInRhc2tCa2dDb2xvciI6IiM4YTkwZGQiLCJ0YXNrVGV4dExpZ2h0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0Q29sb3IiOiJ3aGl0ZSIsInRhc2tUZXh0RGFya0NvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dE91dHNpZGVDb2xvciI6ImJsYWNrIiwidGFza1RleHRDbGlja2FibGVDb2xvciI6IiMwMDMxNjMiLCJhY3RpdmVUYXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwiYWN0aXZlVGFza0JrZ0NvbG9yIjoiI2JmYzdmZiIsImdyaWRDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQmtnQ29sb3IiOiJsaWdodGdyZXkiLCJkb25lVGFza0JvcmRlckNvbG9yIjoiZ3JleSIsImNyaXRCb3JkZXJDb2xvciI6IiNmZjg4ODgiLCJjcml0QmtnQ29sb3IiOiJyZWQiLCJ0b2RheUxpbmVDb2xvciI6InJlZCIsImxhYmVsQ29sb3IiOiJibGFjayIsImVycm9yQmtnQ29sb3IiOiIjNTUyMjIyIiwiZXJyb3JUZXh0Q29sb3IiOiIjNTUyMjIyIiwiY2xhc3NUZXh0IjoiIzEzMTMwMCIsImZpbGxUeXBlMCI6IiNFQ0VDRkYiLCJmaWxsVHlwZTEiOiIjZmZmZmRlIiwiZmlsbFR5cGUyIjoiaHNsKDMwNCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGUzIjoiaHNsKDEyNCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIiwiZmlsbFR5cGU0IjoiaHNsKDE3NiwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU1IjoiaHNsKC00LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTYiOiJoc2woOCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwiZmlsbFR5cGU3IjoiaHNsKDE4OCwgMTAwJSwgOTMuNTI5NDExNzY0NyUpIn19LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

Each level has at most $3^i$ nodes and each node has a cost of at most $cn/2^i$, therefore each level costs at most $cn(3/2)^i$. The overall height of the tree is $\log_2n$.

It follows that $T_3(n)\leq cn \sum_{i=0}^{\log_2n}(3/2)^i=3c3^{\log_2n}-2cn$ using the properties of the geometric series. Using the logarithm properties, it follows that $T_3(n)\leq 3cn^{\log_23}-2cn$. Since $\log_23>1$, it follows that $T_3(n)\in\mathcal{O}(n^{\log_23})$.

Using instead the substitution method, $cn^{\log_23}-dn$ and $c'n$ are chosen as representatives of the sets $\mathcal{O}(n^{\log_23})$ and $\mathcal{O}(n)$. The inductive hypothesis is $T_3(m)\leq cm^{\log_23}-dm$ for all $m<n$.

It follows that the recursive equation is rewritten as $T_3(n)\leq cn^{\log_23}-n(3d/2-c')$. Finally, assuming that $d\geq 2c'$, it follows that $T_3(n)\leq cn^{\log_2 3}-dn$ and so $T_3(n)\in\mathcal{O}(n^{\log_2 3})$.

The fourth equation to be solved is $T_4(n) = 7*T_4(n/2) + \Theta(n^2)$. A recursion tree can be used to model this equation. The first two levels of the recursion tree relative to $T_4(n)$ are shown in the following graph, where $cn^2$ is chosen as representative of the set $\Theta(n^2)$.

[![](https://mermaid.ink/img/eyJjb2RlIjoiZ3JhcGggVERcblx0MShcImNuXjJcIikgLS0-IDIoXCJjKG4vMileMlwiKVxuICAxKFwiY25eMlwiKSAtLT4gMyhcImMobi8yKV4yXCIpXG4gIDEoXCJjbl4yXCIpIC0tPiA0KFwiYyhuLzIpXjJcIilcbiAgMShcImNuXjJcIikgLS0-IDUoXCJjKG4vMileMlwiKVxuICAxKFwiY25eMlwiKSAtLT4gNihcImMobi8yKV4yXCIpXG4gIDEoXCJjbl4yXCIpIC0tPiA3KFwiYyhuLzIpXjJcIilcbiAgMShcImNuXjJcIikgLS0-IDgoXCJjKG4vMileMlwiKVxuIiwibWVybWFpZCI6eyJ0aGVtZSI6ImRlZmF1bHQiLCJmbG93Y2hhcnQiOnsiY3VydmUiOiJiYXNpcyJ9LCJ0aGVtZVZhcmlhYmxlcyI6eyJiYWNrZ3JvdW5kIjoid2hpdGUiLCJwcmltYXJ5Q29sb3IiOiIjRUNFQ0ZGIiwic2Vjb25kYXJ5Q29sb3IiOiIjZmZmZmRlIiwidGVydGlhcnlDb2xvciI6ImhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwicHJpbWFyeUJvcmRlckNvbG9yIjoiaHNsKDI0MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJzZWNvbmRhcnlCb3JkZXJDb2xvciI6ImhzbCg2MCwgNjAlLCA4My41Mjk0MTE3NjQ3JSkiLCJ0ZXJ0aWFyeUJvcmRlckNvbG9yIjoiaHNsKDgwLCA2MCUsIDg2LjI3NDUwOTgwMzklKSIsInByaW1hcnlUZXh0Q29sb3IiOiIjMTMxMzAwIiwic2Vjb25kYXJ5VGV4dENvbG9yIjoiIzAwMDAyMSIsInRlcnRpYXJ5VGV4dENvbG9yIjoicmdiKDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxLCA5LjUwMDAwMDAwMDEpIiwibGluZUNvbG9yIjoiIzMzMzMzMyIsInRleHRDb2xvciI6IiMzMzMiLCJtYWluQmtnIjoiI0VDRUNGRiIsInNlY29uZEJrZyI6IiNmZmZmZGUiLCJib3JkZXIxIjoiIzkzNzBEQiIsImJvcmRlcjIiOiIjYWFhYTMzIiwiYXJyb3doZWFkQ29sb3IiOiIjMzMzMzMzIiwiZm9udEZhbWlseSI6IlwidHJlYnVjaGV0IG1zXCIsIHZlcmRhbmEsIGFyaWFsIiwiZm9udFNpemUiOiIxNnB4IiwibGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsIm5vZGVCa2ciOiIjRUNFQ0ZGIiwibm9kZUJvcmRlciI6IiM5MzcwREIiLCJjbHVzdGVyQmtnIjoiI2ZmZmZkZSIsImNsdXN0ZXJCb3JkZXIiOiIjYWFhYTMzIiwiZGVmYXVsdExpbmtDb2xvciI6IiMzMzMzMzMiLCJ0aXRsZUNvbG9yIjoiIzMzMyIsImVkZ2VMYWJlbEJhY2tncm91bmQiOiIjZThlOGU4IiwiYWN0b3JCb3JkZXIiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJhY3RvckJrZyI6IiNFQ0VDRkYiLCJhY3RvclRleHRDb2xvciI6ImJsYWNrIiwiYWN0b3JMaW5lQ29sb3IiOiJncmV5Iiwic2lnbmFsQ29sb3IiOiIjMzMzIiwic2lnbmFsVGV4dENvbG9yIjoiIzMzMyIsImxhYmVsQm94QmtnQ29sb3IiOiIjRUNFQ0ZGIiwibGFiZWxCb3hCb3JkZXJDb2xvciI6ImhzbCgyNTkuNjI2MTY4MjI0MywgNTkuNzc2NTM2MzEyOCUsIDg3LjkwMTk2MDc4NDMlKSIsImxhYmVsVGV4dENvbG9yIjoiYmxhY2siLCJsb29wVGV4dENvbG9yIjoiYmxhY2siLCJub3RlQm9yZGVyQ29sb3IiOiIjYWFhYTMzIiwibm90ZUJrZ0NvbG9yIjoiI2ZmZjVhZCIsIm5vdGVUZXh0Q29sb3IiOiJibGFjayIsImFjdGl2YXRpb25Cb3JkZXJDb2xvciI6IiM2NjYiLCJhY3RpdmF0aW9uQmtnQ29sb3IiOiIjZjRmNGY0Iiwic2VxdWVuY2VOdW1iZXJDb2xvciI6IndoaXRlIiwic2VjdGlvbkJrZ0NvbG9yIjoicmdiYSgxMDIsIDEwMiwgMjU1LCAwLjQ5KSIsImFsdFNlY3Rpb25Ca2dDb2xvciI6IndoaXRlIiwic2VjdGlvbkJrZ0NvbG9yMiI6IiNmZmY0MDAiLCJ0YXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwidGFza0JrZ0NvbG9yIjoiIzhhOTBkZCIsInRhc2tUZXh0TGlnaHRDb2xvciI6IndoaXRlIiwidGFza1RleHRDb2xvciI6IndoaXRlIiwidGFza1RleHREYXJrQ29sb3IiOiJibGFjayIsInRhc2tUZXh0T3V0c2lkZUNvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dENsaWNrYWJsZUNvbG9yIjoiIzAwMzE2MyIsImFjdGl2ZVRhc2tCb3JkZXJDb2xvciI6IiM1MzRmYmMiLCJhY3RpdmVUYXNrQmtnQ29sb3IiOiIjYmZjN2ZmIiwiZ3JpZENvbG9yIjoibGlnaHRncmV5IiwiZG9uZVRhc2tCa2dDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQm9yZGVyQ29sb3IiOiJncmV5IiwiY3JpdEJvcmRlckNvbG9yIjoiI2ZmODg4OCIsImNyaXRCa2dDb2xvciI6InJlZCIsInRvZGF5TGluZUNvbG9yIjoicmVkIiwibGFiZWxDb2xvciI6ImJsYWNrIiwiZXJyb3JCa2dDb2xvciI6IiM1NTIyMjIiLCJlcnJvclRleHRDb2xvciI6IiM1NTIyMjIiLCJjbGFzc1RleHQiOiIjMTMxMzAwIiwiZmlsbFR5cGUwIjoiI0VDRUNGRiIsImZpbGxUeXBlMSI6IiNmZmZmZGUiLCJmaWxsVHlwZTIiOiJoc2woMzA0LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTMiOiJoc2woMTI0LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTQiOiJoc2woMTc2LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTUiOiJoc2woLTQsIDEwMCUsIDkzLjUyOTQxMTc2NDclKSIsImZpbGxUeXBlNiI6ImhzbCg4LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTciOiJoc2woMTg4LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkifX0sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiZ3JhcGggVERcblx0MShcImNuXjJcIikgLS0-IDIoXCJjKG4vMileMlwiKVxuICAxKFwiY25eMlwiKSAtLT4gMyhcImMobi8yKV4yXCIpXG4gIDEoXCJjbl4yXCIpIC0tPiA0KFwiYyhuLzIpXjJcIilcbiAgMShcImNuXjJcIikgLS0-IDUoXCJjKG4vMileMlwiKVxuICAxKFwiY25eMlwiKSAtLT4gNihcImMobi8yKV4yXCIpXG4gIDEoXCJjbl4yXCIpIC0tPiA3KFwiYyhuLzIpXjJcIilcbiAgMShcImNuXjJcIikgLS0-IDgoXCJjKG4vMileMlwiKVxuIiwibWVybWFpZCI6eyJ0aGVtZSI6ImRlZmF1bHQiLCJmbG93Y2hhcnQiOnsiY3VydmUiOiJiYXNpcyJ9LCJ0aGVtZVZhcmlhYmxlcyI6eyJiYWNrZ3JvdW5kIjoid2hpdGUiLCJwcmltYXJ5Q29sb3IiOiIjRUNFQ0ZGIiwic2Vjb25kYXJ5Q29sb3IiOiIjZmZmZmRlIiwidGVydGlhcnlDb2xvciI6ImhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwicHJpbWFyeUJvcmRlckNvbG9yIjoiaHNsKDI0MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJzZWNvbmRhcnlCb3JkZXJDb2xvciI6ImhzbCg2MCwgNjAlLCA4My41Mjk0MTE3NjQ3JSkiLCJ0ZXJ0aWFyeUJvcmRlckNvbG9yIjoiaHNsKDgwLCA2MCUsIDg2LjI3NDUwOTgwMzklKSIsInByaW1hcnlUZXh0Q29sb3IiOiIjMTMxMzAwIiwic2Vjb25kYXJ5VGV4dENvbG9yIjoiIzAwMDAyMSIsInRlcnRpYXJ5VGV4dENvbG9yIjoicmdiKDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxLCA5LjUwMDAwMDAwMDEpIiwibGluZUNvbG9yIjoiIzMzMzMzMyIsInRleHRDb2xvciI6IiMzMzMiLCJtYWluQmtnIjoiI0VDRUNGRiIsInNlY29uZEJrZyI6IiNmZmZmZGUiLCJib3JkZXIxIjoiIzkzNzBEQiIsImJvcmRlcjIiOiIjYWFhYTMzIiwiYXJyb3doZWFkQ29sb3IiOiIjMzMzMzMzIiwiZm9udEZhbWlseSI6IlwidHJlYnVjaGV0IG1zXCIsIHZlcmRhbmEsIGFyaWFsIiwiZm9udFNpemUiOiIxNnB4IiwibGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsIm5vZGVCa2ciOiIjRUNFQ0ZGIiwibm9kZUJvcmRlciI6IiM5MzcwREIiLCJjbHVzdGVyQmtnIjoiI2ZmZmZkZSIsImNsdXN0ZXJCb3JkZXIiOiIjYWFhYTMzIiwiZGVmYXVsdExpbmtDb2xvciI6IiMzMzMzMzMiLCJ0aXRsZUNvbG9yIjoiIzMzMyIsImVkZ2VMYWJlbEJhY2tncm91bmQiOiIjZThlOGU4IiwiYWN0b3JCb3JkZXIiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJhY3RvckJrZyI6IiNFQ0VDRkYiLCJhY3RvclRleHRDb2xvciI6ImJsYWNrIiwiYWN0b3JMaW5lQ29sb3IiOiJncmV5Iiwic2lnbmFsQ29sb3IiOiIjMzMzIiwic2lnbmFsVGV4dENvbG9yIjoiIzMzMyIsImxhYmVsQm94QmtnQ29sb3IiOiIjRUNFQ0ZGIiwibGFiZWxCb3hCb3JkZXJDb2xvciI6ImhzbCgyNTkuNjI2MTY4MjI0MywgNTkuNzc2NTM2MzEyOCUsIDg3LjkwMTk2MDc4NDMlKSIsImxhYmVsVGV4dENvbG9yIjoiYmxhY2siLCJsb29wVGV4dENvbG9yIjoiYmxhY2siLCJub3RlQm9yZGVyQ29sb3IiOiIjYWFhYTMzIiwibm90ZUJrZ0NvbG9yIjoiI2ZmZjVhZCIsIm5vdGVUZXh0Q29sb3IiOiJibGFjayIsImFjdGl2YXRpb25Cb3JkZXJDb2xvciI6IiM2NjYiLCJhY3RpdmF0aW9uQmtnQ29sb3IiOiIjZjRmNGY0Iiwic2VxdWVuY2VOdW1iZXJDb2xvciI6IndoaXRlIiwic2VjdGlvbkJrZ0NvbG9yIjoicmdiYSgxMDIsIDEwMiwgMjU1LCAwLjQ5KSIsImFsdFNlY3Rpb25Ca2dDb2xvciI6IndoaXRlIiwic2VjdGlvbkJrZ0NvbG9yMiI6IiNmZmY0MDAiLCJ0YXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwidGFza0JrZ0NvbG9yIjoiIzhhOTBkZCIsInRhc2tUZXh0TGlnaHRDb2xvciI6IndoaXRlIiwidGFza1RleHRDb2xvciI6IndoaXRlIiwidGFza1RleHREYXJrQ29sb3IiOiJibGFjayIsInRhc2tUZXh0T3V0c2lkZUNvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dENsaWNrYWJsZUNvbG9yIjoiIzAwMzE2MyIsImFjdGl2ZVRhc2tCb3JkZXJDb2xvciI6IiM1MzRmYmMiLCJhY3RpdmVUYXNrQmtnQ29sb3IiOiIjYmZjN2ZmIiwiZ3JpZENvbG9yIjoibGlnaHRncmV5IiwiZG9uZVRhc2tCa2dDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQm9yZGVyQ29sb3IiOiJncmV5IiwiY3JpdEJvcmRlckNvbG9yIjoiI2ZmODg4OCIsImNyaXRCa2dDb2xvciI6InJlZCIsInRvZGF5TGluZUNvbG9yIjoicmVkIiwibGFiZWxDb2xvciI6ImJsYWNrIiwiZXJyb3JCa2dDb2xvciI6IiM1NTIyMjIiLCJlcnJvclRleHRDb2xvciI6IiM1NTIyMjIiLCJjbGFzc1RleHQiOiIjMTMxMzAwIiwiZmlsbFR5cGUwIjoiI0VDRUNGRiIsImZpbGxUeXBlMSI6IiNmZmZmZGUiLCJmaWxsVHlwZTIiOiJoc2woMzA0LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTMiOiJoc2woMTI0LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTQiOiJoc2woMTc2LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTUiOiJoc2woLTQsIDEwMCUsIDkzLjUyOTQxMTc2NDclKSIsImZpbGxUeXBlNiI6ImhzbCg4LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTciOiJoc2woMTg4LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkifX0sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

Each level has $7^i$ nodes and each node has a cost of $cn^2/4^i$, therefore each level costs $cn^2(7/4)^i$. The overall height of the tree is $\log_2n$.

It follows that $T_4(n) = cn^2 \sum_{i=0}^{\log_2n}(7/4)^i=7/3c7^{\log_2n}-4/3cn^2$ using the properties of the geometric series. Using the logarithm properties, it follows that $T_4(n) = 7/3cn^{\log_27}-4/3cn^2$. Since $\log_27>2$, it follows that $T_4(n)\in\Theta(n^{\log_27})$.

Using instead the substitution method, $cn^{\log_27}-dn^2$ and $c'n$ are chosen as representatives of the sets $\mathcal{O}(n^{\log_27})$ and $\Theta(n^2)$. The inductive hypothesis is $T_4(m)\leq cm^{\log_27}-dm^2$ for all $m<n$.

It follows that the recursive equation is rewritten as $T_4(n)\leq cn^{\log_27}-n^2(7d/4-c')$. Finally, assuming that $d\geq 4/3c'$, it follows that $T_4(n)\leq cn^{\log_2 7}-dn^2$ and so $T_4(n)\in\mathcal{O}(n^{\log_2 7})$.

Now $cn^{\log_27}$ and $c'$ are chosen as representatives of the sets $\Omega(n^{\log_27})$ and $\Theta(1)$. Assuming as inductive hypothesis $T_4(m)\geq cm^{\log_27}$ for all $m<n$, the recursive equation is rewritten as $T_4(n)\geq cn^{\log_27}+c'n^2$. Finally, assuming that $c'\geq 0$, it follows that $T_4(n)\geq cn^{\log_27}$ and so $T_4(n)\in\Omega(n^{\log_27})$.

Putting both bounds together, it follows that $T_4(n)\in\Theta(n^{\log_27})$.